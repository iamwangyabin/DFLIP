
model:
  base_model: "dinov2_vitb14"
  cache_dir: "./models_cache"
  num_generators: 10  # Number of generator model classes (including Real=0)
  freeze_encoder: true
  use_lora: false

  side_network:
    extract_layers: [6, 12, 18]  # Intermediate layers to extract features from
    fusion_strategy: "concat"     # Options: concat, add, attention
    hidden_dim: 1024              # Should match VIT hidden size



bhep:
  enabled: true
  num_families: 3
  num_versions: 20
  # Hierarchy mapping: List of version indices for each family
  # Example: 3 families, splitting 20 versions
  hierarchy:
    - [0, 1, 2, 3, 4, 5, 6]        # family 0: versions 0-6
    - [7, 8, 9, 10, 11, 12, 13]    # family 1: versions 7-13
    - [14, 15, 16, 17, 18, 19]     # family 2: versions 14-19
  lambda_edl: 0.1
  lambda_kl: 0.5

data:
  # Dataset paths
  metadata_path: "./assets/dflip3k_meta.json"
  image_root: "./data/images"
  
  # Data augmentation
  image_size: 448
  augmentation:
    horizontal_flip: true
    rotation_range: 15
    brightness_range: 0.1
    contrast_range: 0.1
  
  # Dataloader settings
  num_workers: 4
  pin_memory: true

training:
  batch_size: 8
  gradient_accumulation_steps: 4
  num_epochs: 10

  optimizer: "adamw"
  learning_rate: 2.0e-4
  weight_decay: 0.01
  adam_beta1: 0.9
  adam_beta2: 0.999
  adam_epsilon: 1.0e-8

  lr_scheduler_type: "cosine"
  warmup_ratio: 0.1

  loss_weights:
    detection: 1.0
    identification: 1.0

  fp16: false
  bf16: true

  save_strategy: "epoch"
  save_total_limit: 3
  output_dir: "./checkpoints/stage1"

  logging_steps: 10
  eval_strategy: "epoch"



# ===========================
# Logging & Monitoring
# ===========================
logging:
  use_wandb: true
  wandb_project: "dflip-linguistic-profiling"
  wandb_entity: null  # Set your wandb username here
  log_level: "INFO"

# ===========================
# Hardware Settings
# ===========================
hardware:
  seed: 42
  cuda_deterministic: true
  dataloader_num_workers: 4
  
  # Distributed training
  ddp: false
  local_rank: -1
  
  # DeepSpeed (optional)
  use_deepspeed: false
  deepspeed_config: null
